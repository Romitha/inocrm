.modal-header
  = label_tag "Search Contact Person"
  %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
    %span{"aria-hidden" => "true"} &times;
  = @header
.modal-body
  .row
    .col-lg-12
      #select_contact_persons
        = form_tag create_contact_persons_tickets_path, method: :post, remote: true do
          .input-group
            = text_field_tag "search_contact_person", nil, class: "form-control"
            %span.input-group-btn
              = submit_tag "Search", name: submit_contact_person, class: "btn btn-default"
  %br/
  %ul#myTab.nav.nav-tabs{:role => "tablist"}
    %li{:role => "presentation"}
      %a{"aria-controls" => "contact_Person", "data-toggle" => "tab", :href => "#contact_Person", :role => "tab"} Contact Person
    %li{:role => "presentation"}
      %a{"aria-controls" => "customer", "data-toggle" => "tab", :href => "#customer", :role => "tab"} Customer

  .tab-content

    #contact_Person.tab-pane{:role => "tabpanel"}
      .row

        = paginate contact_persons, remote: true, method: :post if contact_persons.present?
        .table-responsive.col-md-8.table-stiped.table
          %table.table
            %thead
              %tr
                %th
                  Name
                %th
                  Contacts
                %th
                  Ticket
                %th
                  Function
            %tbody
              - contact_persons.each do |contact_person|
                %tr
                  %td
                    #{contact_person.mst_title.try(:title)} #{contact_person.name}

                  %td
                    - contact_person.contact_person_contact_types.each do |c_value|
                      #{c_value.contact_type.name}: #{c_value.value}
                      %br/

                  %td
                    - contact_person.tickets.each do |ticket|
                      #{ticket.ticket_no.to_s.rjust(5, INOCRM_CONFIG["ticket_no_format"])} #{ticket.ticket_status.name}
                    %br/
                    =link_to "More>>", "#"
                  %td
                    = link_to "select", "#", onclick: "Tickets.assign_contact_person('#{contact_person.id}', '#{submitted_contact_person}', 'assign_contact_person'); false;"
                    = link_to "edit", "#", onclick: "Tickets.assign_contact_person('#{contact_person.id}', '#{submitted_contact_person}', 'edit_create_contact_person'); false;"
    #customer.tab-pane{:role => "tabpanel"}
      #contact_persons
        .row
          = paginate customers, remote: true, method: :post if customers.present?

          .table-responsive.col-md-8.table-stiped.table
            %table.table
              %thead
                %tr
                  %th
                    Name
                  %th
                    Address
                  %th
                    Contacts
                  %th
                    Ticket
                  %th
                    Function
              %tbody
                - customers.each do |customer|
                  %tr
                    %td
                      #{customer.mst_title.try(:title)} #{customer.name}
                    %td
                      = customer.address1
                      %br/
                      = customer.address2
                      %br/
                      = customer.address3
                      %br/
                      = customer.address4
                    %td
                      - customer.contact_type_values.each do |c_value|
                        #{c_value.contact_type.name}: #{c_value.value}
                        %br/

                    %td
                      - customer.tickets.each do |ticket|
                        #{ticket.ticket_no.to_s.rjust(5, INOCRM_CONFIG["ticket_no_format"])} #{ticket.ticket_status.name}
                      %br/
                      =link_to "More>>", "#"
                    %td
                      = link_to "select", "#", onclick: "Tickets.assign_contact_person('#{customer.id}', '#{submitted_contact_person}','initiate_contact_person'); false;"

.modal-footer
  %button.btn.btn-default{"data-dismiss" => "modal", :type => "button"} Close