%fieldset
  %legend Request Spare Part
  = simple_nested_form_for @ticket_spare_part, url: update_request_spare_part_ticket_path(ticket), method: :post do |f|

    = hidden_field_tag :process_id, session[:process_id]
    = hidden_field_tag :task_id, session[:task_id]
    = hidden_field_tag :owner, session[:owner]

    = f.input :ticket_id, as: :hidden
    = f.input :status_action_id, as: :hidden, input_html: {value: SparePartStatusAction.find_by_code("RQT").id}
    = f.input :status_use_id, as: :hidden, input_html: {value: SparePartStatusUse.find_by_code("NAP").id}
    - if ticket.ticket_type.code == 'OS'
      .row
        = f.association :ticket_fsr, collection: ticket.ticket_fsrs.map{|tf| [tf.id, tf.id]}#, wrapper_html: {class: "col-md-3"}, label: "FSR No"
    .row
      = f.input :spare_part_no, wrapper_html: {class: "col-md-3"}, required: true
    .row
      = f.input :spare_part_description, wrapper_html: {class: "col-md-3"}, label: "Part Description", input_html: {class: "typeahead", autocomplete: "off", spellcheck: "false"}, placeholder: "Part number", required: true

      = f.input :cus_chargeable_part, as: :boolean, checked_value: true, unchecked_value: false, wrapper: :append, wrapper_html: {class: "col-md-3"}, input_html: {checked: (true if @ticket_spare_part.ticket.warranty_type.code == "NW"), disabled: (true if @ticket_spare_part.ticket.warranty_type.code == "NW")}
      .col-md-3
        = f.input :request_from, as: :radio_buttons, collection: {"Manufacture" => "M", "Store" => "S"}, wrapper: :append, wrapper_html: {class: "col-md-12"}, disabled: ("M" unless @ticket_spare_part.ticket.warranty_type.code == "MW")
        = link_to "select", inventory_in_modal_inventories_path, remote: true
      .col-md-3
        = label_tag "Part of main product"
        = check_box_tag :part_of_main_product
        = link_to "select", inventory_in_modal_inventories_path, remote: true

    .row
      = f.input :faulty_serial_no, wrapper_html: {class: "col-md-3"}, label: "Faulty Serial No"
    .row
      = f.input :faulty_ct_no, wrapper_html: {class: "col-md-3"}, label: "Fault CT No"
    .row
      = f.input :note, wrapper_html: {class: "col-md-6"}, label: "Note"
    = f.submit "Save", class: "btn btn-success"

#inventory_modal.modal.fade{tabindex: -1, role: "dialog", "aria-labelledby" => "inventory_modal", "aria-hidden" => true}
  .modal-dialog.modal-lg
    .modal-content