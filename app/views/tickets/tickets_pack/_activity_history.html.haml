#activity_history_list
  .row
    .col-md-12.small_scale_margin-top1.small_scale_margin-bottom1
      - ["user", "activity"].each do |t|
        = label_tag "by #{t}"
        = radio_button_tag 'action_radio', t, false, class: "activity_radio_class"

    .col-md-6.hide.user_radio_wrapper
      = label_tag "by user"
      = select_tag "activity_history_select_user", options_for_select(@user_ticket_actions.uniq{|a| a.action_by}.collect{|action| Rails.cache.fetch([:action_by, action.action_by]){User.find(action.action_by)}.full_name }), class: "chosen-select", id: "live_search_select_activity_history_user", include_blank: "All"
    .col-md-6.hide.activity_radio_wrapper
      = label_tag "by activity"
      = select_tag "activity_history_select_activity", options_for_select(@user_ticket_actions.collect{|action| action.task_action.action_description}), class: "chosen-select", id: "live_search_select_activity_history_activity", include_blank: "All"
  .row#activity_history_template.small_scale_margin-top1.small_scale_margin-bottom1
    .col-md-12.padding0.fancy_scroll_bar.activity_history_live_search_list{style: "max-height: 466px; overflow: auto;"}
      - @user_ticket_actions.each do |action|
        - if action.persisted?
          .panel-group
            .panel.panel-info
              .panel-heading
                .row
                  .col-md-4
                    Activity:
                    %span.action_description= action.task_action.action_description
                  .col-md-3
                    Date Time:
                    = action.action_at.strftime "#{INOCRM_CONFIG['short_date_format']} #{INOCRM_CONFIG['time_format']}"
                  .col-md-3
                    %p
                      By:
                      %span.user_name #{Rails.cache.fetch([:action_by, action.action_by]){User.find(action.action_by)}.full_name}

                  .col-md-2
                    %p Re-Open: #{action.re_open_index > 0 ? 'Yes ('+action.re_open_index.to_s+')' : 'No'}

              - if action.action_id == 2 and action.user_assign_ticket_action.present?
                .panel-body 
                  .row
                    .col-md-3
                      SBU: #{action.user_assign_ticket_action.try(:sbu).try(:sbu)}
                    - if action.user_assign_ticket_action.assign_to
                      .col-md-3
                        Assign to: #{User.find_by_id(action.user_assign_ticket_action.try(:assign_to)).try(:full_name)}
                    .col-md-3
                      -if action.user_assign_ticket_action.recorrection == true
                        Recorrection: Yes
                      -else
                        Recorrection: No
                    .col-md-3
                      -if action.user_assign_ticket_action.recorrection == true
                        Regional Support Center Job: No
                      -else
                        Regional Support Center Job: No

              - elsif action.action_id == 4 and action.assign_regional_support_centers.present?
                .panel-body
                  - action.assign_regional_support_centers.each do |b|
                    .row
                      .col-md-4
                        Regional Support Center: #{Organization.find(b.regional_support_center.organization_id).name}

              - elsif action.action_id == 5
                .panel-body
                  .row
                    .col-md-4
                      Start Action: #{action.ticket.ticket_start_action.try(:action)}
                    .col-md-4
                      Start Note: #{action.ticket.job_start_note}

              - elsif action.action_id == 6 and action.ticket_re_assign_request.present?
                .panel-body
                  .row
                    .col-md-4
                      Reason: #{action.ticket_re_assign_request.reason.reason}

              - elsif action.action_id == 7 and action.ticket_terminate_job.present?
                .panel-body
                  .row
                    .col-md-4
                      Reason: #{action.ticket_terminate_job.reason.reason}

              - elsif action.action_id == 8 and action.act_hold.present?
                .panel-body 
                  .row
                    .col-md-4
                      Reason: #{action.act_hold.reason.reason}

              - elsif action.action_id == 9
                .panel-body
                  .row
                    .col-md-4
                      Reason: #{ticket.user_ticket_actions.find_by_id(ticket.last_hold_action_id).act_hold.reason.reason}

              - elsif action.action_id == 10 and action.serial_request.present?
                .panel-body 
                  .row
                    .col-md-4
                      Reason: #{action.serial_request.reason}

              - elsif action.act_fsr.present?
                - if action.action_id == 11
                  .panel-body 
                    .row
                      .col-md-4
                        FSR No :
                        -if action.act_fsr.fsr_id
                          = action.act_fsr.ticket_fsr.ticket_fsr_no.to_s.rjust(6, INOCRM_CONFIG["fsr_no_format"])
                      .col-md-4
                        -if action.act_fsr.print_fsr == true
                          Print FSR : Yes
                        - else
                          Print FSR : No

                - elsif action.action_id == 12
                  .panel-body 
                    .row
                      .col-md-3
                        FSR No :
                        -if action.act_fsr.fsr_id
                          = action.act_fsr.ticket_fsr.ticket_fsr_no.to_s.rjust(6, INOCRM_CONFIG["fsr_no_format"])
                      .col-md-3
                        Date:
                        = action.act_fsr.ticket_fsr.created_at.try(:strftime, INOCRM_CONFIG['short_date_format'])
                      .col-md-3
                        User:
                        = User.find_by_id(action.act_fsr.ticket_fsr.created_by).try(:full_name)
                      .col-md-3
                        / Remarks: #{simple_format action.act_fsr.ticket_fsr.remarks}
                    .row
                      .col-md-3
                        Work Started At: #{action.act_fsr.ticket_fsr.try(:work_started_at).try(:strftime, INOCRM_CONFIG['short_date_format'])}
                      .col-md-3
                        Work Finished At: #{action.act_fsr.ticket_fsr.try(:work_finished_at).try(:strftime, INOCRM_CONFIG['short_date_format'])}
                      .col-md-3
                        Hours Worked: #{action.act_fsr.ticket_fsr.try(:hours_worked)}
                      .col-md-3
                        Down Time: #{action.act_fsr.ticket_fsr.try(:down_time)}

                    .row
                      .col-md-3
                        Engineer Time Travel: #{action.act_fsr.ticket_fsr.try(:engineer_time_travel)}
                      .col-md-3
                        Engineer Time On Site: #{action.act_fsr.ticket_fsr.try(:engineer_time_on_site)}
                      .col-md-3
                        Resolution: #{simple_format action.act_fsr.ticket_fsr.try(:resolution)}
                      .col-md-3
                        Approved:
                        - if action.act_fsr.ticket_fsr.approved == true
                          Yes
                        - else
                          No
                    .row
                      .col-md-3
                        Completion Level: #{action.act_fsr.ticket_fsr.try(:completion_level)}
                      / .col-md-3
                      /   Remarks: #{action.act_fsr.ticket_fsr.try(:completion_level)}
                      .col-md-3
                        Print Count #{action.act_fsr.ticket_fsr.try(:print_count)}
                      .col-md-3
                        Engineer #{User.find_by_id(action.act_fsr.ticket_fsr.engineer_id).try(:first_name)}
                    .row
                      .col-md-3
                        Other Repair: #{action.act_fsr.ticket_fsr.try(:other_repairs)}
                      .col-md-3
                        Travel Hours: #{action.act_fsr.ticket_fsr.try(:travel_hours)}

                - elsif action.action_id == 70
                  .panel-body 
                    .row
                      .col-md-4
                        FSR No :
                        - if action.act_fsr.fsr_id
                          = action.act_fsr.ticket_fsr.ticket_fsr_no.to_s.rjust(6, INOCRM_CONFIG["fsr_no_format"])
                      .col-md-4
                        -if action.act_fsr.print_fsr == true
                          Print FSR : Yes
                        - else
                          Print FSR : No

              - elsif action.action_id == 13 and action.ticket_action_taken.present?
                .panel-body 
                  .row
                    .col-md-4
                      Action: #{action.ticket_action_taken.action}

              - elsif action.request_spare_part.present?
                - if action.action_id == 14
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        - if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        - else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        - if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        - if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      .col-md-4
                        Payment Expected Manufacture : #{action.request_spare_part.ticket_spare_part.ticket_spare_part_manufacture.try(:payment_expected_manufacture)}
                    .row
                      .col-md-4
                        Reason: #{action.request_spare_part.try(:reject_return_part_reason).try(:reason)}

                - elsif action.action_id == 15
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        - if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        - else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        Store Requested By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store_requested_by)).try(:full_name)}
                      .col-md-4
                        Store Request Approved By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.request_approved_by).try(:full_name)}
                      .col-md-4
                        Store Issued By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:issued_by)).try(:full_name)}
                    .row
                      .col-md-4
                        - if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        - if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      - if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}
                    .row
                      .col-md-4
                        Reason: #{action.request_spare_part.try(:reject_return_part_reason).try(:reason)}


                - elsif action.action_id == 16
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4 
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}
                    .row
                      .col-md-4
                        Reason: #{action.request_spare_part.try(:reject_return_part_reason).try(:reason)}

                - elsif action.action_id == 17
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4 
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}
                    .row
                      .col-md-4
                        Reason: #{action.request_spare_part.try(:reject_return_part_reason).try(:reason)}

                - elsif action.action_id == 19
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4 
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        = action.request_spare_part.ticket_spare_part.part_terminated_reason.try(:reason)
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}

                - elsif action.action_id == 31
                  .panel-body 
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                    .row
                      .col-md-4
                        - if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        - else
                          Customer Chargeable: No
                      .col-md-4
                        - if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        - if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                    .row
                      - if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}

                - elsif action.action_id == 33
                  .panel-body 
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}

                - elsif action.action_id == 34
                  .panel-body 
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        Reason: #{action.request_spare_part.part_terminate_reason.try(:reason)}
                    .row
                      .col-md-3
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                      .col-md-3
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-2
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}

                - elsif action.action_id == 36
                  .panel-body 
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4 
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}

                - elsif action.action_id == 37
                  .panel-body 
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4 
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-2
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}

                - elsif action.action_id == 38
                  .panel-body 
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4 
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}

                - elsif action.action_id == 42
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4 
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        Reject Reason: #{action.request_spare_part.reject_return_part_reason.try(:reason)}
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store

                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.inventory_product.generated_item_code}

                    .row
                      .col-md-4
                        Bundle No:
                        #{action.request_spare_part.ticket_spare_part.try(:ticket_spare_part_manufacture).try(:return_parts_bundle).try(:bundle_no)}

                - elsif action.action_id == 43
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}

                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                    .row
                      .col-md-4
                        Reject Return Part Reason: #{action.request_spare_part.reject_return_part_reason.try(:reason)}

                    .row
                      .col-md-4
                        Bundle No:
                        #{action.request_spare_part.ticket_spare_part.try(:ticket_spare_part_manufacture).try(:return_parts_bundle).try(:bundle_no)}

                - elsif action.action_id == 44
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                    .row
                      .col-md-4
                        - if action.request_spare_part.part_terminate_reason
                          Part Terminate Reason: #{action.request_spare_part.part_terminate_reason.reason}
                    .row
                      .col-md-4
                        Bundle No:
                        #{action.request_spare_part.ticket_spare_part.try(:ticket_spare_part_manufacture).try(:return_parts_bundle).try(:bundle_no)}

                - elsif action.action_id == 45
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}

                - elsif action.action_id == 46
                  - ticket_spare_part_manufacture = action.request_spare_part.ticket_spare_part.ticket_spare_part_manufacture
                  - if ticket_spare_part_manufacture.present?
                    .panel-body
                      .row
                        .col-md-4
                          Bundled id: #{ticket_spare_part_manufacture.return_parts_bundle_id}
                        .col-md-4
                          Bundled by: #{User.find_by_id(ticket_spare_part_manufacture.add_bundle_by).try(:full_name)}

                - elsif action.action_id == 47
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.try(:spare_part_no)}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4 
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.approved_inventory_product.generated_item_code}

                    -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                      .row
                        .col-md-4
                          Store Requested By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store_requested_by)).try(:full_name)}
                        .col-md-4
                          Store Request Approved By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.request_approved_by).try(:full_name)}
                        .col-md-4
                          Store Issued By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:issued_by)).try(:full_name)}


                - elsif action.action_id == 48
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.try(:spare_part_no)}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4 
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.approved_inventory_product.generated_item_code}

                    -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                      .row
                        .col-md-4
                          Store Requested By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store_requested_by)).try(:full_name)}
                        .col-md-4
                          Store Request Approved By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.request_approved_by).try(:full_name)}
                        .col-md-4
                          Store Issued By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:issued_by)).try(:full_name)}

                - elsif action.action_id == 64
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      .col-md-4
                        Payment Expected Manufacture : #{action.request_spare_part.ticket_spare_part.ticket_spare_part_manufacture.try(:payment_expected_manufacture)}

                - elsif action.action_id == 78
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        Store Requested By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store_requested_by)).try(:full_name)}
                      .col-md-4
                        Store Request Approved By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.request_approved_by).try(:full_name)}
                      .col-md-4
                        Store Issued By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:issued_by)).try(:full_name)}
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.approved_inventory_product.generated_item_code}

                - elsif action.action_id == 79
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        Store Requested By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store_requested_by)).try(:full_name)}
                      .col-md-4
                        Store Request Approved By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.request_approved_by).try(:full_name)}
                      .col-md-4
                        Store Issued By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:issued_by)).try(:full_name)}
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.approved_inventory_product.generated_item_code}

                - elsif action.action_id == 86
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        Store Requested By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store_requested_by)).try(:full_name)}
                      .col-md-4
                        Store Request Approved By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.request_approved_by).try(:full_name)}
                      .col-md-4
                        Store Issued By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:issued_by)).try(:full_name)}
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.approved_inventory_product.generated_item_code}


                - elsif action.action_id == 89
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        Store Requested By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store_requested_by)).try(:full_name)}
                      .col-md-4
                        Store Request Approved By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.request_approved_by).try(:full_name)}
                      .col-md-4
                        Store Issued By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:issued_by)).try(:full_name)}
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.approved_inventory_product.generated_item_code}


                - elsif action.action_id == 90
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        Store Requested By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store_requested_by)).try(:full_name)}
                      .col-md-4
                        Store Request Approved By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.request_approved_by).try(:full_name)}
                      .col-md-4
                        Store Issued By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:issued_by)).try(:full_name)}
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.approved_inventory_product.generated_item_code}


                - elsif action.action_id == 93
                  .panel-body
                    .row
                      .col-md-4
                        Spare Part No: #{action.request_spare_part.ticket_spare_part.spare_part_no}
                      .col-md-4
                        Spare Part Description: #{action.request_spare_part.ticket_spare_part.spare_part_description}
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.cus_chargeable_part == true
                          Customer Chargeable: Yes
                        -else
                          Customer Chargeable: No
                    .row
                      .col-md-4
                        Store Requested By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store_requested_by)).try(:full_name)}
                      .col-md-4
                        Store Request Approved By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.request_approved_by).try(:full_name)}
                      .col-md-4
                        Store Issued By: #{User.find_by_id(action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:issued_by)).try(:full_name)}
                    .row
                      .col-md-4
                        -if action.request_spare_part.ticket_spare_part.request_from == 'M'
                          Request From Manufacture
                        -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                          Request From Store
                      -if action.request_spare_part.ticket_spare_part.request_from == 'S'
                        .col-md-4
                          Store: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.try(:store).try(:name)}
                        .col-md-4
                          Product Item Code: #{action.request_spare_part.ticket_spare_part.ticket_spare_part_store.approved_inventory_product.generated_item_code}

              - elsif action.request_on_loan_spare_part.present?
                - if action.action_id == 18
                  .panel-body
                    .row
                      .col-md-4
                        Store: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.store.try(:name)}
                      .col-md-4
                        Product Item Code: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.inventory_product.try(:generated_item_code)}
                      .col-md-4
                        Product Description: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.inventory_product.try(:description)}

                - elsif action.action_id == 49
                  .panel-body
                    .row
                      .col-md-4
                        Store: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.store.try(:name)}
                      .col-md-4
                        Requested Product Item Code: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.inventory_product.try(:generated_item_code)}
                      .col-md-4
                        Requested Product Description: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.inventory_product.try(:description)}
                      .col-md-4
                        Approved Store: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_store.try(:name)}
                      .col-md-4
                        Approved Product Item Code: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:generated_item_code)}
                      .col-md-4
                        Approved Product Description: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:description)}


                - elsif action.action_id == 50
                  .panel-body
                    .row
                      .col-md-4
                        Approved Store: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_store.try(:name)}
                      .col-md-4
                        Approved Product Item Code: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:generated_item_code)}
                      .col-md-4
                        Approved Product Description: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:description)}


                - elsif action.action_id == 51
                  .panel-body
                    .row
                      .col-md-4
                        Approved Store: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_store.try(:name)}
                      .col-md-4
                        Approved Product Item Code: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:generated_item_code)}
                      .col-md-4
                        Approved Product Description: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:description)}


                - elsif action.action_id == 52
                  .panel-body
                    .row
                      .col-md-4
                        Approved Store: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_store.try(:name)}
                      .col-md-4
                        Approved Product Item Code: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:generated_item_code)}
                      .col-md-4
                        Approved Product Description: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:description)}


                - elsif action.action_id == 53
                  .panel-body
                    .row
                      .col-md-4
                        Approved Store: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_store.try(:name)}
                      .col-md-4
                        Approved Product Item Code: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:generated_item_code)}
                      .col-md-4
                        Approved Product Description: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:description)}


                - elsif action.action_id == 54
                  .panel-body
                    .row
                      .col-md-4
                        Approved Store: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_store.try(:name)}
                      .col-md-4
                        Approved Product Item Code: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:generated_item_code)}
                      .col-md-4
                        Approved Product Description: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:description)}

                - elsif action.action_id == 65
                  .panel-body
                    .row
                      .col-md-4
                        Approved Store: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_store.try(:name)}
                      .col-md-4
                        Approved Product Item Code: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:generated_item_code)}
                      .col-md-4
                        Approved Product Description: #{action.request_on_loan_spare_part.ticket_on_loan_spare_part.approved_inventory_product.try(:description)}
                  

              - elsif action.action_id == 20 and action.hp_case.present?
                .panel-body 
                  .row
                    .col-md-4
                      Case ID.: #{action.hp_case.try :case_id}
                    .col-md-4
                      Case Note: #{action.hp_case.try :case_note}

              -elsif action.action_id == 21 and action.ticket_finish_job.present?
                .panel-body 
                  .row
                    .col-md-4
                      Resolution: #{simple_format action.ticket_finish_job.try :resolution}

              - elsif action.deliver_unit.present?
                - if action.action_id == 22
                  .panel-body
                    .row
                      .col-md-4
                        -if action.deliver_unit.ticket_deliver_unit.collected == true
                          Collect Unit From Supplier: Yes
                        -else
                          Collect Unit From Supplier: No
                      .col-md-4
                        Deliver To Supplier By: #{User.cached_find_by_id(action.deliver_unit.ticket_deliver_unit.collected_by).try(:full_name)}
                      .col-md-4
                        Receive Note: #{action.deliver_unit.try(:receive_note)}
                    .row
                      .col-md-4
                        Deliver Note: #{action.deliver_unit.deliver_note}

                - elsif action.action_id == 25
                  .panel-body 
                    .row
                      .col-md-4
                        -if action.deliver_unit.ticket_deliver_unit.collected == true
                          Collect Unit From Supplier: Yes
                        -else
                          Collect Unit From Supplier: No
                      .col-md-4
                        Deliver To Supplier By: #{User.cached_find_by_id(action.deliver_unit.ticket_deliver_unit.collected_by).try(:full_name)}
                      .col-md-4
                        Receive Note: #{action.deliver_unit.try(:receive_note)}

                - elsif action.action_id == 29
                  .panel-body 
                    .row
                      .col-md-4
                        - if action.deliver_unit.ticket_deliver_unit.delivered_to_sup
                          Deliver To Supplier: Yes
                        - else
                          Deliver To Supplier: No
                      .col-md-4
                        Deliver To Supplier By: #{User.cached_find_by_id(action.deliver_unit.ticket_deliver_unit.delivered_to_sup_by).try(:full_name)}
                      .col-md-4
                        Receive Note: #{action.deliver_unit.try(:receive_note)}
                    .row
                      .col-md-12
                        Deliver Note: #{action.deliver_unit.deliver_note}


                - elsif action.action_id == 30
                  .panel-body
                    .row
                      .col-md-4
                        -if action.deliver_unit.ticket_deliver_unit.collected == true
                          Collect Unit From Supplier: Yes
                        -else
                          Collect Unit From Supplier: No
                      .col-md-4
                        Deliver To Supplier By: #{User.cached_find_by_id(action.deliver_unit.ticket_deliver_unit.collected_by).try(:full_name)}
                      .col-md-4
                        Receive Note: #{action.deliver_unit.try(:receive_note)}
                    .row
                      .col-md-12
                        Deliver Note: #{action.deliver_unit.deliver_note}

              - elsif action.act_job_estimation.try(:ticket_estimation).present?
                - if action.action_id == 23
                  .panel-body
                    .row
                      .col-md-4
                        Note: #{action.act_job_estimation.try(:note)}
                      .col-md-4
                        Requested by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.requested_by).try(:full_name)}
                      .col-md-4
                        Estimated by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.estimated_by).try(:full_name)}
                    .row
                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.approved
                          Ticket estimation approved: yes
                        - else
                          Ticket estimation approved: no
                      .col-md-4
                        Approved by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.approved_by).try(:full_name)}

                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.cust_approved
                          Customer approved: yes
                        - else
                          Customer approved: no

                - elsif action.action_id == 24
                  .panel-body
                    .row
                      .col-md-4
                        Note: #{action.act_job_estimation.try(:note)}
                      .col-md-4
                        Requested by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.requested_by).try(:email)}
                      .col-md-4
                        Estimated by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.estimated_by).try(:email)}
                    .row
                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.approved == true
                          Ticket estimation approved: yes
                        - else
                          Ticket estimation approved: no
                      .col-md-4
                        Approved by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.approved_by).try(:email)}

                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.cust_approved == true
                          Customer approved: yes
                        - else
                          Customer approved: no

                - elsif action.action_id == 27
                  .panel-body 
                    .row
                      .col-md-4
                        Note: #{action.act_job_estimation.try(:note)}
                      .col-md-4
                        Requested by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.requested_by).try(:email)}
                      .col-md-4
                        Estimated by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.estimated_by).try(:email)}
                    .row
                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.approved
                          Ticket estimation approved: yes
                        - else
                          Ticket estimation approved: no
                      .col-md-4
                        Approved by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.approved_by).try(:email)}

                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.cust_approved
                          Customer approved: yes
                        - else
                          Customer approved: no

                - elsif action.action_id == 41
                  .panel-body 
                    .row
                      .col-md-4
                        -if action.act_job_estimation.ticket_estimation.approved
                          Approved
                        -else
                          Not Approved
                      .col-md-4
                        Supplier #{action.act_job_estimation.organization.name}
                      .col-md-4
                        Note #{action.act_job_estimation.try(:note)}

                - elsif action.action_id == 74
                  .panel-body
                    .row
                      .col-md-4
                        Note: #{action.act_job_estimation.try(:note)}
                      .col-md-4
                        Requested by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.requested_by).try(:email)}
                      .col-md-4
                        Estimated by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.estimated_by).try(:email)}
                    .row
                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.approved == true
                          Ticket estimation approved: yes
                        - else
                          Ticket estimation approved: no
                      .col-md-4
                        Approved by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.approved_by).try(:email)}
                        
                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.cust_approved == true
                          Customer approved: yes
                        - else
                          Customer approved: no   

                - elsif action.action_id == 75
                  .panel-body
                    .row
                      .col-md-4
                        Note: #{action.act_job_estimation.try(:note)}
                      .col-md-4
                        Requested by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.requested_by).try(:email)}
                      .col-md-4
                        Estimated by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.estimated_by).try(:email)}
                    .row
                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.approved == true
                          Ticket estimation approved: yes
                        - else
                          Ticket estimation approved: no
                      .col-md-4
                        Approved by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.approved_by).try(:email)}
                        
                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.cust_approved == true
                          Customer approved: yes
                        - else
                          Customer approved: no

                - elsif action.action_id == 76
                  .panel-body
                    .row
                      .col-md-4
                        Note: #{action.act_job_estimation.try(:note)}
                      .col-md-4
                        Requested by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.requested_by).try(:email)}
                      .col-md-4
                        Estimated by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.estimated_by).try(:email)}
                    .row
                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.approved == true
                          Ticket estimation approved: yes
                        - else
                          Ticket estimation approved: no
                      .col-md-4
                        Approved by: #{User.cached_find_by_id(action.act_job_estimation.ticket_estimation.approved_by).try(:email)}
                        
                      .col-md-4
                        - if action.act_job_estimation.ticket_estimation.cust_approved == true
                          Customer approved: yes
                        - else
                          Customer approved: no

              - elsif action.act_payment_received.present?
                - if action.action_id == 28
                  .panel-body
                    .row
                      .col-md-4
                        Payment received amount: #{action.act_payment_received.ticket_payment_received.try(:amount)}
                      .col-md-4
                        / Invoice No: #{action.act_payment_received.ticket_payment_received.ticket_invoice.try(:invoice_no).to_s.rjust(6, INOCRM_CONFIG['invoice_no_format'])}
                        Invoice No:
                        - if action.act_payment_received.ticket_payment_received.ticket_invoice
                          = action.act_payment_received.ticket_payment_received.ticket_invoice.try(:invoice_no).to_s.rjust(6, INOCRM_CONFIG['invoice_no_format'])
                      .col-md-4
                        Receipt Description: #{action.act_payment_received.ticket_payment_received.try(:receipt_description)}

                - elsif action.action_id == 77 and action.act_payment_received.present?
                  .panel-body
                    .row
                      .col-md-4
                        Payment received amount: #{action.act_payment_received.ticket_payment_received.try(:amount)}
                      .col-md-4
                        Invoice No:
                        - if action.act_payment_received.ticket_payment_received.ticket_invoice
                          = action.act_payment_received.ticket_payment_received.ticket_invoice.try(:invoice_no).to_s.rjust(6, INOCRM_CONFIG['invoice_no_format'])
                      .col-md-4
                        Receipt Description: #{action.act_payment_received.ticket_payment_received.try(:receipt_description)}

              - elsif action.action_warranty_extend.present?
                - action_warranty_extend = action.action_warranty_extend

                - if action.action_id == 32
                  .panel-body
                    .row
                      .col-md-4
                        Extended: #{boolean_in_word action.action_warranty_extend.extended, "Yes", "No"}
                      .col-md-4
                        Reject Reason: #{action_warranty_extend.reject_reason.try(:reason)}
                      .col-md-4
                        Reject Note: #{action_warranty_extend.try(:note)}
                    .row
                      .col-md-4
                        Request Note: #{action_warranty_extend.reject_note}

                - elsif action.action_id == 39 and action.action_warranty_extend.present?
                  .panel-body
                    .row
                      .col-md-4
                        - if action_warranty_extend.extended == true
                          Extended: Yes
                        - else
                          Extended: No
                      .col-md-4
                        Reject Reason: #{action_warranty_extend.try(:reject_reason).try(:reason)}
                      .col-md-4
                        Reject Note: #{action_warranty_extend.try(:note)}

                - elsif action.action_id == 40
                  .panel-body 
                    .row
                      .col-md-4
                        = boolean_in_word action_warranty_extend.extended, "Yes", "No"

                      .col-md-4
                        Reject Reason: #{action_warranty_extend.reject_reason.try(:reason)}
                      .col-md-4
                        Reject Note: #{action_warranty_extend.reject_note}

              - elsif action.action_id == 56 and action.act_ticket_close_approve.present?
                .panel-body
                  .row
                    .col-md-4
                      - if action.act_ticket_close_approve.approved
                        Approved: Yes
                      - else
                        Approved: No
                    .col-md-4
                      Reject Reason: #{action.act_ticket_close_approve.reason.try(:reason)}

              - elsif action.action_id == 66
                .panel-body
                  .row
                    .col-md-4
                      - if action.act_ticket_close_approve.approved
                        Approved: Yes
                      - else
                        Approved: No
                    .col-md-4
                      Reject Reason: #{action.act_ticket_close_approve.reason.try(:reason)}

              - elsif action.act_quality_control.present?
                - if action.action_id == 57
                  .panel-body
                    .row
                      .col-md-4
                        - if action.act_quality_control.approved == true
                          Approved: yes
                        - else
                          Approved: no
                      .col-md-4
                        Reject Reason: #{action.act_quality_control.try(:reject_reason)}

                - elsif action.action_id == 67
                  .panel-body
                    .row
                      .col-md-4
                        - if action.act_quality_control.approved
                          Approved: yes
                        - else
                          Approved: no
                      .col-md-4
                        Reject Reason: #{action.try(:act_quality_control).try(:reject_reason)}

              - elsif action.customer_feedback.present?
                - if action.action_id == 58
                  .panel-body
                    .row
                      .col-md-3
                        - if action.customer_feedback.re_opened
                          Re-open: yes
                          %br/
                          Re-open reason: #{action.customer_feedback.try(:re_open_reason)}

                        - else
                          Re-open: no

                      .col-md-3
                        - if action.customer_feedback.payment_completed
                          Payment completed: yes
                        - else
                          Payment completed: no

                      .col-md-3
                        Feedback: #{action.customer_feedback.try(:feedback).try(:feedback)}                      
                      .col-md-3
                        Feedback Description: #{action.customer_feedback.try(:feedback_description)}

                    .row
                      .col-md-3
                        Unit return custumer: #{boolean_in_word action.customer_feedback.try(:unit_return_customer), "Yes", "No"}
                      .col-md-3
                        Dispatch method: #{action.customer_feedback.try(:dispatch_method).try(:name)}

                - elsif action.action_id == 60
                  .panel-body
                    .row
                      .col-md-3
                        - if action.customer_feedback.re_opened
                          Re-open: yes
                        - else
                          Re-open: no
                      .col-md-3
                        - if action.customer_feedback.payment_completed
                          Payment completed: yes
                        - else
                          Payment completed: no

                      .col-md-3
                        Feedback: #{action.customer_feedback.try(:feedback).try(:feedback)}                      
                      .col-md-3
                        Feedback Description: #{action.customer_feedback.try(:feedback_description)}

                    .row
                      .col-md-3
                        Unit return custumer: #{bolean_in_word action.customer_feedback.try(:unit_return_customer), "Yes", "No"}
                      .col-md-3
                        Dispatch method: #{action.customer_feedback.try(:dispatch_method).try(:name)}


              - elsif action.action_id == 61 and action.inform_customer.present?
                .panel-body
                  .row
                    .col-md-4
                      Contact type: #{action.inform_customer.ticket_contact_type.try(:name)}
                    .col-md-4
                      Note: #{action.inform_customer.try(:note)}

              - elsif action.act_print_invoice.present?
                - if action.action_id == 71
                  .panel-body
                    .row
                      .col-md-4
                        Invoice no: #{action.act_print_invoice.invoice.try(:invoice_no).to_s.rjust(6, INOCRM_CONFIG['invoice_no_format']) }
                      .col-md-4
                        Note: #{action.act_print_invoice.invoice.try(:note) }
                      .col-md-4
                        Print Count: #{action.act_print_invoice.invoice.try(:print_count)}

                - elsif action.action_id == 80
                  .panel-body
                    .row
                      .col-md-4
                        / Invoice no: #{action.act_print_invoice.invoice.try(:invoice_no).to_s.rjust(6, INOCRM_CONFIG['invoice_no_format']) }
                        Invoice No: #{ticket.final_invoice.try(:invoice_no).to_s.rjust(6, INOCRM_CONFIG["invoice_no_format"])}
                      .col-md-4
                        Note: #{action.act_print_invoice.invoice.try(:note) }
                      .col-md-4
                        Print Count: #{action.act_print_invoice.invoice.try(:print_count)}

                - elsif action.action_id == 83
                  .panel-body
                    .row
                      .col-md-4
                        Invoice no: #{action.act_print_invoice.invoice.invoice_no.to_s.rjust(6, INOCRM_CONFIG['invoice_no_format']) }
                      .col-md-4
                        Note: #{action.act_print_invoice.invoice.note }
                      .col-md-4
                        Print Count: #{action.act_print_invoice.invoice.print_count}

              - elsif action.action_warranty_repair_type.present?
                - if action.action_id == 72
                  .panel-body
                    .row
                      .col-md-4
                        Warranty type: #{action.action_warranty_repair_type.warranty_type.try(:name)}
                      .col-md-4
                        Repaired type: #{action.action_warranty_repair_type.ticket_repair_type.try(:name)}
                      .col-md-4
                        -if action.action_warranty_repair_type.cus_chargeable == true
                          customer chargeable: yes
                        - else
                          customer chargeable: no


                - elsif action.action_id == 73
                  .panel-body
                    .row
                      .col-md-4
                        Warranty type: #{action.action_warranty_repair_type.warranty_type.try(:name)}
                      .col-md-4
                        Repaired type: #{action.action_warranty_repair_type.ticket_repair_type.try(:name)}
                      .col-md-4
                        -if action.action_warranty_repair_type.cus_chargeable == true
                          customer chargeable: yes
                        - else
                          customer chargeable: no

              - elsif action.act_quotation.present?
                - if action.action_id == 81
                  .panel-body
                    .row
                      .col-md-4
                        Customer quotation no: #{action.act_quotation.customer_quotation.try(:customer_quotation_no)}
                      .col-md-4
                        Currency: #{action.act_quotation.customer_quotation.currency.try(:currency)}
                      .col-md-4
                        Validity period: #{action.act_quotation.customer_quotation.try(:validity_period)}
                    .row
                      .col-md-4
                        Delivery period: #{action.act_quotation.customer_quotation.try(:delivery_period)}
                      .col-md-4
                        Warranty: #{action.act_quotation.customer_quotation.try(:warranty)}
                      .col-md-4
                        Note: #{action.act_quotation.customer_quotation.try(:note)}

                - elsif action.action_id == 82
                  .panel-body
                    .row
                      .col-md-4
                        Customer quotation no: #{action.act_quotation.customer_quotation.try(:customer_quotation_no)}
                      .col-md-4
                        Currency: #{action.act_quotation.customer_quotation.currency.try(:currency)}
                      .col-md-4
                        Validity period: #{action.act_quotation.customer_quotation.try(:validity_period)}
                    .row
                      .col-md-4
                        Delivery period: #{action.act_quotation.customer_quotation.try(:delivery_period)}
                      .col-md-4
                        Warranty: #{action.act_quotation.customer_quotation.try(:warranty)}
                      .col-md-4
                        Note: #{action.act_quotation.customer_quotation.try(:note)}

                - elsif action.action_id == 84
                  .panel-body
                    .row
                      .col-md-4
                        Customer quotation no: #{action.act_quotation.customer_quotation.try(:customer_quotation_no)}
                      .col-md-4
                        Currency: #{action.act_quotation.customer_quotation.currency.try(:currency)}
                      .col-md-4
                        Validity period: #{action.act_quotation.customer_quotation.try(:validity_period)}
                    .row
                      .col-md-4
                        Delivery period: #{action.act_quotation.customer_quotation.try(:delivery_period)}
                      .col-md-4
                        Warranty: #{action.act_quotation.customer_quotation.try(:warranty)}
                      .col-md-4
                        Note: #{action.act_quotation.customer_quotation.try(:note)}
